# 2장 컴퓨터 시스템과 하드웨어

## 컴퓨터 시스템과 하드웨어
<br>

### 컴퓨터 시스템의 범위

#### 컴퓨터 시스템의 계층
1. 응용 프로그램 층

2. 운영체제 층

3. 컴퓨터 하드웨어 층
<br><br>

#### 컴퓨터 시스템의 계층 구조의 특징
- 하드웨어는 모두 **운영체제의 배타적 독점적 지배** 받음

- 사용자 또는 프로그램이 하드웨어에 대한 **직접 접근 불허** 

    → **반드시 운영체제를 통해서만 접근 가능**

    → **사용자가 하드웨어에 대해 몰라도 컴퓨터 사용 가능**
<br><br>

#### 컴퓨터 하드웨어 종류

- **CPU**
    
    컴퓨터의 핵심 장치, 프로그램 코드를 해석하여 실행하는 중앙 처리 장치
    
    **📌 CPU 구성 요소** : **ALU, 제어 장치, 레지스터**
    - ALU : 다양한 산술 및 논리 연산을 수행
    <br><br>
    ![alt text](./[현준]%20Image/3.png)
    **레지스터**를 통해 입력받은 **피연산자**로 계산하여 계산 결과는 **Flag Register**에 저장한다.
    <br><br>
    ![alt text](./[현준]%20Image/image-1.png)
    <br><br>
    - 제어 장치 : 시스템 전체의 효율적인 작동을 위해 전기적 제어 신호를 발생, 다른 컴퓨터 부품들을 제어
        
        1. Clock 신호를 받아들임
        
        2. 레지스터에서 **명령어**와, 플래그 레지스터에서 **플래그**를 받아들임
        
        3. 제어 버스로 전달된 제어 신호를 받아들임 → 다양한 장치에서 제어 신호가 옴

        4. 제어 신호를 다른 장치에 보낼 수 있다.
    <br><br>
    - 레지스터 : 프로그램 속 명령어와 데이터가 저장되는 공간
        
        1. **프로그램 카운터(Program Counter, PC)** 
        
            - **명령어의 주소**를 저장하는 레지스터, 다음 명령어의 위치를 가리킴

        2. **명령어 레지스터(Command Register, Instruction Register, IR)** 
        
            - 현재 CPU가 해석하고 있는 **명령어**를 저장하는 공간
            
            - 어떤 연산을 수행할지 결정하는데 중요한 역할


        3. **메모리 주소 레지스터(Memory Address Register, MAR)**

            - **메모리의 주소**를 기록하는 레지스터

            - 주소를 레지스터에 기록해두고, 메모리에 접근할 수 있음


        4. **메모리 버퍼 레지스터(Memory Buffer Register, MBR)**

            - 메모리와 주고 받을 **데이터**와 명령어를 저장하는 공간

            - 메모리에서 읽어온 데이터가 여기 저장되어 사용됨

            - 메모리에 데이터를 기록할 때도 여기에 저장됨

        5. **범용 레지스터(General Purpose Register)**
            - 다양한 목적으로 사용 되는 레지스터

            - 임시 데이터 저장소, 연산 결과 중간 결과 저장소

        6. **플래그 레지스터(Flag Register)**
            - 여러 플래그를 저장해두는 레지스터

        7. **스택 포인터 레지스터(Stack Pointer Register)**
            -  스택의 톱 메모리 주소 저장
    
    <br>    
    
    📌 **32비트 컴퓨터?**
        
        한 번에 32비트를 처리할 수 있는 내부 구조를 갖는 CPU 
    - 32개의 주소선이 있고, 2^32개 바이트, 4GB 넘어선 영역은 사용할 수 없음
    
    ![alt text](./[현준]%20Image/4.png)

    <br>    
    
    📌 **CPU 기계 명령**
        
    - CPU가 해석하고 실행할 수 있는 **2진수의 기계 명령**
    
    - 2진수인 기계어로 직접 프로그래밍 하기 어려워, 어셈블리어로 코딩할 수 있음  

    <br>    
    
    📌 **CPU의 명령 처리 과정**

    ![alt text](./[현준]%20Image/5.png)
    **< 메모리 100번지에 저장된 명령어를 실행 >**
    
    1. **프로그램 카운터 레지스터**에 **100**을 담아 주소 버스에 싣는다.

    2. 메모리 100번지에 있는 명령어를 가져와 데이터 버스에 싣는다.

    3. 가져온 데이터를 IR 레지스터에 저장하고 PC를 다음 번지로 수정한다.
        - 가져온 데이터 : `mov eax, [300]` (메모리 300번지의 값을 읽어 eax 레지스터에 저장)
    4. CPU는 300번지를 주소 버스에 싣는다.
    
    5. 메모리 300번지에 저장된 데이터를 **데이터 버스**에 싣는다.

    6. CPU는 **임시 데이터 레지스터**에 데이터를 저장한다
    
    7. 명령 실행 결과인 50을 **eax 레지스터** 저장한다.

<br><br>

- **메모리**

        CPU에 의해 실행되는 프로그램 코드와 데이터가 적재되는 공간

    - **스택**
       
        - 메모리의 일부를 스택으로 사용하도록 할당된 공간
        
        - Stack Pointer Register가 스택 꼭대기를 가리킴

        - **저장되는 내용**
            - 함수의 **지역 변수**들
            - 함수가 호출될 때 전달받은 **매개 변수** 값들

            - 함수가 실행된 후 **돌아갈 주소**
            - 함수가 의도적으로 **저장해 두기 위한 값**
    
    - ⭐ 컨텍스트 (문맥)

        - 한 프로그램이 실행 중인 일체의 상황 혹은 상황 정보 
        
        - 아래 값들을 하나로 문맥으로 관리함

            - **CPU**의 PC, SP, 기타 레지스터 값
            - **메모리**의 프로그램 코드와 데이터, 스택, 동적 할당을 받아 저장한 값
        
        **⭐ 컨텍스트 스위칭**
            
            CPU가 현재 프로그램의 실행 중지하고, 다른 프로그램을 실행할 때 발생

        - 컨텍스트에 프로그램의 마지막 상태가 저장됨 

            ![alt text](./[현준]%20Image/6.png)
        
        <br>

        - Context Switching 과정
            
            1. 현재 실행중인 프로그램의 컨텍스트를 메모리에 저장

            2. 새로 실행시킬 프로그램의 저장된 컨텍스트를 CPU에 복귀 