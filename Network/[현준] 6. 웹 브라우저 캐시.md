# 6장 웹 브라우저 캐시

## 로컬 스토리지의 개념

> **로컬 스토리지**는 **웹 스토리지 객체**로 브라우저 내에 `{key : value}` 형태로 오리진에 종속되어 저장되는 데이터를 말한다.

<br>

### ❓ 오리진이란?

웹 브라우저의 주소에서 `protocol` 부터 `port` 까지를 오리진이라고 한다.

URL이 다음과 같이 구성되는데,


| protocol | hostname | port | path | query String | 
| :--: | :--: | :--: | :--: | :--: |
| http:// | www.naver.com | 8080 | /path | ?name=hyeon

여기서 `http://www.naver.com:8080`까지를 오리진이라고 하고, 오리진이 동일한 곳에는 하나의 로컬 스토리지를 가진다

<br>

### 로컬 스토리지의 특징
- **하나의 키**에 **하나의 값** 저장

- 사용자가 삭제하기 전까지, 데이터는 평생 로컬 저장소에 저장되어 **만료되지 않는다.**

- 사용자가 창을 닫거나 컴퓨터를 종료해도 **삭제되지 않는다**

- 최대 저장 용량 : 5MB

- 로컬 스토리지의 데이터는 서버에 정송되지 않는다.  (쿠키는 자동으로 전송됨)

**클라이언트**가 JavaScript로 로컬 스토리지를 조작 할 수 있다. 

- 아이템 추가 : `window.localStorage.setItem(key, value)`

- 아이템 읽기 : `window.localStorage.getItem(key)`

- 아이템 삭제 : `window.localStorage.removeItem(key)`

또한 개발자에 의해 만료 시간을 설정할 수도 있습니다.

<br>

### 크롬에서 로컬 스토리지 값 확인하기

1. F12를 눌러 개발자 도구를 클릭합니다.

2. 'Application' 탭을 클릭합니다.

3. Storage > Local Storage 탭을 클릭하여 확인합니다.

    ![alt text](./[현준]%20Image/image-11.png)


<br>

## 세션 스토리지

> 세션 스토리지는 로컬 스토리지와 매우 유사하다.
`{key : value}` 형태로 오리진에 종속되어 저장된다.

### 세션 스토리지 특징

- **하나의 키**에 **하나의 값** 저장

- 최대 저장 용량 : 5MB

- ⭐ 사용자가 브라우저 탭을 닫으면 데이터가 만료된다.

일반적으로는 세션 스토리지보다 **로컬 스토리지**를 더 많이 사용한다.

로컬 스토리지와 동일하게 개발자 옵션에서 확인이 가능하다

![alt text](./[현준]%20Image/image-12.png)


<br>

## 쿠키

- 웹 브라우저 상에 작은 텍스트 파일로 저장이 되는 **만료 기간이 존재하는 저장소**를 의미

### 쿠키의 특징

- 쿠키는 브라우저를 종료하더라도 유지됨

- `cookie-name = cookie-value`로 저장됨

- 하나의 String 내에 속성을 **세미콜론**을 기준으로 구분 짓는다.

- **개인 정보가 포함된 보안 정보를 사용해서는 안된다**

- Authentication 인증 정보 또는 세션에 저장된 토큰 값 등 보안에 필요한 정보를 저장하는 용도로 사용한다.

- 쿠키는 **특정 시간 초과 후에 쿠키 데이터를 무효화하는 것이 중요하다**

- 최대 저장 용량 : **4KB**

- 서버도 설정이 가능하다.

<br>

### 세션 쿠키 VS 영구 쿠키

- 세션 쿠키 : `Expires` 또는 `Max-Age` 속성을 지정하지 않아 브라우저가 종료되면 쿠키도 사라진다

- 영구 쿠키 : `Expires` 또는 `Max-Age` 속성을 지정하여, **일정 기간이 지나면 삭제되게 만든 쿠키로 브라우저를 닫아도 만료되지 않는다**.

<br>

### 그 외 기타 옵션
- Secure : HTTPS로만 쿠키를 주고 받을 수 있게 하는 옵션

- HttpOnly : 자바스크립트 명령어로 쿠키 데이터를 확인할 수 없게 한다. `document.cookie`로 데이터에 접근할 수 없다.

- SameSite : 요청이 동일한 도메인에서 시작된 경우에만 쿠키가 어플리케이션으로 전송되도록 허용한다.


### 쿠키 허용 관련 알림창

서비스 운용 시 쿠키를 사용한다면 쿠키 허용 관련 알림창을 만들어야 한다.

방문 기록을 추적할 때 쿠키가 사용되기 때문에, 사용자 데이터 간접 수집에 해당하며 

한국 인터넷 진흥원의 지침을 준수 해야한다.

## 로컬 스토리지, 세션 스토리지, 쿠키의 공통점

- 브라우저에 캐상하여 서버로의 요청을 줄이고, 서버 부하를 방지할 수 있다.

- 캐싱 덕에 매법 다운로드 해야하는 콘텐츠가 줄어 웹 사이트의 전체 콘텐츠를 더 빨리 다운로드 할 수 있다.

- 다크모드, 글꼴 등 사이트 기본 설정 커스터마이징 설정을 저장하거나, 로그인 상태를 유지할 때 사용된다.