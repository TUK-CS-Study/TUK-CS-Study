## OSI 7계층
> OSI 7계층은 네트워크 통신이 일어나는 과정을 국제 표준화 기구(ISO)에서 정한 네트워크 표준 모델
- 각 계층마다 헤더가 붙게되어, 수신하면 역순으로 헤더를 분석한다.

![alt text](./[현준]%20Image/9-1.png)

### 물리 계층
- 주로 전기적, 기계적, 기능적인 특성을 이용해서 통신 케이블로 데이터를 전송하는 물리적인 장비

- 단지 데이터 전기적인 신호(0,1)로 변환해서 주고받는 기능만 할 뿐
- 이 계층에서 사용되는 통신 단위 : 비트(Bit)이며 이것은 1과 0으로 나타내어지는, 즉 전기적으로 On, Off 상태
- 장비 : 통신 케이블, 리피터, 허브 등

### 링크 계층

- **링크 계층이 제공하는 서비스**
    - 프레임화 : 데이터필드와 여러 헤더들을 프레임화 하여 캡슐화
    
    - 링크 접속 : 매체 접속 제어 (MAC) 프로토콜은 링크상으로 프레임을 전송하는 규칙 명시

    - 신뢰적 전달 : 확인 응답과, 재전송을 통해 신뢰적 전달하는 기능을 함

    - 오류 검출과 정정 : 잘못된 프레임 비트를 반대로 오인할 수 있으므로 오류를 검출하는데 쓰인다. 보통 하드웨어에서 처리하여 복잡하다. 
        - 패리티 비트, 체크섬, 순환 중복 검사

- 링크 계층은 NIC (Network Interface Card)에 구현 된다.<br><br>
![alt text](./[현준]%20Image/10.png)    

- **두 종류의 네트워크 링크**
    - 점대점 링크
        - 링크의 한쪽 끝에 한 송신자와 링크의 다른 쪽 끝에 한 수신자가 있다.
        
        - PPP(point-to-point protocol)
            - 두 양간의 통신을 하도록 도와주는 프로토콜
            
            - 두개의 노드에서 Connection 개설, 유지, 관리 및 시험 및 종료하는 역할을 한다.
        - HDLC(high-level data link control)
            - 고속 데이터 전송에 적합하고, 비트 전송을 기본으로 하는 범용의 데이터 링크 전송제어절차로써, 컴퓨터간을 연결하는 컴퓨터 네트워크에도 적합한 전송제어방식을 말함

            - 비트 지향적 프로토콜
    - 브로드캐스트 링크 
        - 동일한 하나의 공유된 브로드캐스트 채널에 다수의 송신 노드 및 수신 노드가 연결된다.
        
        - 임의의 한 노드가 프레임을 전송하면 채널이 그 프레임을 브로드캐스트해서 다른 모든 노드가 그 프레임의 복사본을 수신하기 때문에 브로드캐스트 용어가 쓰인다.

- 장비 : 호스트, 라우터, 스위치, AP(access point) 등 

### 네트워크 계층
- 네트워크 계층은 두 호스트 중 하나의 전송 계층 세그먼트를 추출하여 다른 호스트의 전송 계층까지 전달하는 역할

- 전송 단위: 패킷 (데이터그램)

- 대표적인 장비 : 라우터

⭐ 라우터는 네트워크 계층까지 존재하므로, 네트워크 계층이 가장 상위 계층이다.

- 라우터는 데이터 평면, 제어 평면이 존재한다.
    
    - 데이터 평면 : 입력 링크에서 출력 링크로 데이터그램을 전달한다.

    - 제어 평면  : 데이터그램이 출발지 호스트에서 목적지 호스트까지 전달되게끔 로컬 포워딩, 라우터별 포워딩을 대응시킨다.

**[데이터 평면]**
- IP (Internet Protocol)
    - IPv4 데이터 그램 구성
    
    ![alt text](./[현준]%20Image/11.png)

        - 헤더 길이 : IPv4 데이터그램은 헤더에 가변 길이의 옵션을 포함하므로 이 네 비트로 IP 데이터그램에서 실제 페이로드가 시작하는 곳을 결정한다.

        - 프로토콜 : 이 필드는 일반적으로 IP 데이터그램이 최종목적지에 도착했을 때만 사용된다. 이 필드값은 IP 데이터그램에서 데이터 부분이 전달될 목적지의 트랜스포트 계층의 특정 프로토콜(TCP, UDP)을 명시한다.

        - TTL(time to live) : 이 필드는 네트워크에서 데이터그램이 무한히 순환하지 않도록 한다(라우팅 루프). 라우터가 데이터그램을 처리할 때마다 감소하고, 이 필드가 0이 되면 데이터그램을 폐기한다.
        
        - 헤더 체크섬 : 헤더 체크섬은 라우터가 수신한 IP 데이터그램의 비트 오류를 탐지하는데 도움을 준다.

    
    - IPv6 데이터 그램 구성
    
        한정된 IPv4의 주소를 대신하여, IPv6가 나왔다. 무수한 IP 주소로 고갈될 걱정이 덜하다.

    ![alt text](./[현준]%20Image/12.png)

**[제어 평면]**
- 라우팅 알고리즘

    - **링크 상태 알고리즘**
    
        - 네트워크 토폴로지와 모든 링크 비용이 알려져 링크 상태 알고리즘의 입력값으로 사용될 수 있다.

    - **다익스트라 알고리즘**

        - 출발지에서 모든 다른 노드의 최소 비용 경로를 계산하는 알고리즘

    - **거리 벡터 라우팅 알고리즘**

        - 요즘에 많이 사용되는 알고리즘

        - 벨만-포드 식을 사용하여 분산적으로 사용하는 방식

        ![alt text](./[현준]%20Image/13.png)

- 인터넷 제어 메시지 프로토콜(ICMP)
    - 호스트와 라우터 간에 네트워크 계층 정보를 서로 주고 받기 위한 프로토콜

    - ICMP 메시지는 타입(type)과 코드(code) 필드가 있고,
ICMP 메시지의 발생 원인이 된 IP 데이터그램의 헤더와 첫 8바이트를 갖는다.

![alt text](./[현준]%20Image/15.png)


- Border GateWay Protocol(BGP)

    - 패킷이 여러 국가를 통과해야 할때 사용되는 **분산형 비동기식 프로토콜**

### 전송 계층
- 애플리케이션 프로세스에서 네트워크 계층 사이에서 메시지를 운반하는 역할
- Port 번호를 통해 프로세스를 구분
- 전송 단위: 세그먼트

- **전송 과정**
    1. 네트워크 계층에서 `Segment`를 수신한다.

    2. 전송 계층은 `Segment`를 소켓에게 전달한다.
        - 이때 소켓에서 식별할 수 있는 방법은 **포트 번호**로 식별한다.
    ![alt text](./[현준]%20Image/18.png)

- **Transmission Control Protocol, TCP**
    - 신뢰적이고 연결지향형 서비스를 제공한다. (reliable data transfer)
    
    - 혼잡 제어(congestion control) : 혼잡한 네트워크 링크에서 각 TCP 연결이 링크의 대역폭을 공평하게 공유하여 통과하도록 해준다.
    
    - **연결 및 연결 종료**
        - [연결] 3-way handShaking 방식 사용
    
        ![alt text](./[현준]%20Image/image-1.png)
        1. SYN
        2. ACK + SYN
        3. ACK

        - [연결 종료]
        ![alt text](./[현준]%20Image/image-2.png)

    - **TCP 혼잡 제어**
        - 슬로 스타트(slow start) : 첫 연결 이후, 윈도우 값을 1에서 지수적으로 늘리는 방식
            ![alt text](./[현준]%20Image/16.png)
        - 혼잡 회피(congestion avoidance) : 혼잡이 발생하면 윈도우 값을 절반을 줄이는 방식

        - 빠른 회복(fast recovery) : 임계점까지 빠르게 윈도우 값을 증가시키는 방식, 리노와 타호 방식이 있다.
        ![alt text](./[현준]%20Image/17.png)


- **User Datagram Protocol, UDP**
    - 비신뢰적이고 비연결형인 서비스를 제공한다.

    - UDP 트랜스포트 프로토콜을 사용하는 애플리케이션은 허용이 되는 한, 그것이 만족하는 어떤 속도로든 전송할 수 있다.

    - 연결 설정이 없고, 혼잡 제어가 없어 빠르다.

    - 체크섬을 사용하여 오류 검사를 제공한다.

### 세션 계층
- 통신하는 장치 간의 세션을 설정, 유지, 종료하는 역할을 담당하는 계층
- 즉, 통신 중 연결이 끊어지지 않도록 유지시켜주는 역할이고 이를 위한 프로세스들의 논리적 연결 담당
- TCP/IP 세션 연결 설정과 해제, 세션 메시지 전동 등 기능 수행

- 전송 단위: 데이터

### 표현 계층
- 하위 계층에 보내는 데이터를 통신에 알맞은 형태로 만들거나 하위 계층에서 온 데이터를 사용자가 이해할 수 있는 형태로 만드는 역할을 하는 계층
- 즉, 데이터를 사용자나 특정 계층이 이해할 수 있게 변환(압축, 암호화, 복호화)를 수행

- 전송 단위: 데이터

### 응용 계층
- 응용 서비스 수행하는 계층

- 메일, 웹 브라우징 등과 같은 응용 프로그램 서비스

- 전송 단위: 데이터